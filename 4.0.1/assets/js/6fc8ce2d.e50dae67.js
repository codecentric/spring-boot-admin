"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[2320],{721:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>f,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"server/notifications/custom-notifiers","title":"Creating Custom Notifiers","description":"Spring Boot Admin makes it easy to create custom notifiers to integrate with your preferred notification channels. You","source":"@site/docs/02-server/notifications/90-custom-notifiers.md","sourceDirName":"02-server/notifications","slug":"/server/notifications/custom-notifiers","permalink":"/4.0.1/docs/server/notifications/custom-notifiers","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":90,"frontMatter":{"sidebar_position":90,"sidebar_custom_props":{"icon":"bell"}},"sidebar":"sidebar","previous":{"title":"Notifications","permalink":"/4.0.1/docs/server/notifications/"},"next":{"title":"DingTalk Notifications","permalink":"/4.0.1/docs/server/notifications/notifier-dingtalk"}}');var o=n(4848),r=n(8453);const s={sidebar_position:90,sidebar_custom_props:{icon:"bell"}},a="Creating Custom Notifiers",c={},l=[{value:"Overview",id:"overview",level:2},{value:"Using AbstractEventNotifier",id:"using-abstracteventnotifier",level:2},{value:"Basic Example",id:"basic-example",level:3},{value:"Registering the Notifier",id:"registering-the-notifier",level:3},{value:"Advanced Custom Notifier",id:"advanced-custom-notifier",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Filtering Events",id:"filtering-events",level:2},{value:"Using AbstractStatusChangeNotifier",id:"using-abstractstatuschangenotifier",level:2},{value:"Implementing Notifier Interface Directly",id:"implementing-notifier-interface-directly",level:2},{value:"Configuration Properties",id:"configuration-properties",level:2},{value:"Combining with FilteringNotifier",id:"combining-with-filteringnotifier",level:2},{value:"Testing Custom Notifiers",id:"testing-custom-notifiers",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function d(t){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...t.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"creating-custom-notifiers",children:"Creating Custom Notifiers"})}),"\n",(0,o.jsxs)(e.p,{children:["Spring Boot Admin makes it easy to create custom notifiers to integrate with your preferred notification channels. You\ncan extend the built-in notifier base classes or implement the ",(0,o.jsx)(e.code,{children:"Notifier"})," interface directly."]}),"\n",(0,o.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsxs)(e.p,{children:["Notifiers are Spring beans that implement the ",(0,o.jsx)(e.code,{children:"Notifier"})," interface and react to instance events such as status changes,\nregistration, or deregistration."]}),"\n",(0,o.jsx)(e.h2,{id:"using-abstracteventnotifier",children:"Using AbstractEventNotifier"}),"\n",(0,o.jsxs)(e.p,{children:["The recommended approach is to extend ",(0,o.jsx)(e.code,{children:"AbstractEventNotifier"}),", which provides built-in support for:"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Filtering events"}),"\n",(0,o.jsx)(e.li,{children:"Enabling/disabling notifications"}),"\n",(0,o.jsx)(e.li,{children:"Accessing instance details"}),"\n",(0,o.jsx)(e.li,{children:"Error handling"}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"basic-example",children:"Basic Example"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'import de.codecentric.boot.admin.server.domain.entities.Instance;\nimport de.codecentric.boot.admin.server.domain.entities.InstanceRepository;\nimport de.codecentric.boot.admin.server.domain.events.InstanceEvent;\nimport de.codecentric.boot.admin.server.domain.events.InstanceStatusChangedEvent;\nimport de.codecentric.boot.admin.server.notify.AbstractEventNotifier;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport reactor.core.publisher.Mono;\n\npublic class CustomNotifier extends AbstractEventNotifier {\n\n\tprivate static final Logger log = LoggerFactory.getLogger(CustomNotifier.class);\n\n\tpublic CustomNotifier(InstanceRepository repository) {\n\t\tsuper(repository);\n\t}\n\n\t@Override\n\tprotected Mono<Void> doNotify(InstanceEvent event, Instance instance) {\n\t\treturn Mono.fromRunnable(() -> {\n\t\t\tif (event instanceof InstanceStatusChangedEvent statusEvent) {\n\t\t\t\tlog.info("Instance {} ({}) is {}",\n\t\t\t\t\t\tinstance.getRegistration().getName(),\n\t\t\t\t\t\tevent.getInstance(),\n\t\t\t\t\t\tstatusEvent.getStatusInfo().getStatus());\n\t\t\t} else {\n\t\t\t\tlog.info("Instance {} ({}) {}",\n\t\t\t\t\t\tinstance.getRegistration().getName(),\n\t\t\t\t\t\tevent.getInstance(),\n\t\t\t\t\t\tevent.getType());\n\t\t\t}\n\t\t});\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"registering-the-notifier",children:"Registering the Notifier"}),"\n",(0,o.jsx)(e.p,{children:"Register your custom notifier as a Spring bean:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"import org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class NotifierConfiguration {\n\n\t@Bean\n\tpublic CustomNotifier customNotifier(InstanceRepository repository) {\n\t\treturn new CustomNotifier(repository);\n\t}\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"advanced-custom-notifier",children:"Advanced Custom Notifier"}),"\n",(0,o.jsx)(e.p,{children:"Here's a more advanced example that sends notifications to an external API:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'import org.springframework.web.reactive.function.client.WebClient;\nimport reactor.core.publisher.Mono;\n\npublic class WebhookNotifier extends AbstractEventNotifier {\n\n\tprivate static final Logger log = LoggerFactory.getLogger(WebhookNotifier.class);\n\n\tprivate final WebClient webClient;\n\tprivate final String webhookUrl;\n\n\tpublic WebhookNotifier(InstanceRepository repository,\n\t\t\t\t\t\t   WebClient.Builder webClientBuilder,\n\t\t\t\t\t\t   String webhookUrl) {\n\t\tsuper(repository);\n\t\tthis.webhookUrl = webhookUrl;\n\t\tthis.webClient = webClientBuilder.build();\n\t}\n\n\t@Override\n\tprotected Mono<Void> doNotify(InstanceEvent event, Instance instance) {\n\t\treturn Mono.fromSupplier(() -> createNotificationPayload(event, instance))\n\t\t\t\t.flatMap(this::sendWebhookNotification)\n\t\t\t\t.doOnError(ex -> log.error("Failed to send webhook notification", ex))\n\t\t\t\t.then();\n\t}\n\n\tprivate NotificationPayload createNotificationPayload(InstanceEvent event,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  Instance instance) {\n\t\treturn NotificationPayload.builder()\n\t\t\t\t.instanceId(instance.getId().getValue())\n\t\t\t\t.instanceName(instance.getRegistration().getName())\n\t\t\t\t.eventType(event.getType())\n\t\t\t\t.status(instance.getStatusInfo().getStatus())\n\t\t\t\t.timestamp(event.getTimestamp())\n\t\t\t\t.serviceUrl(instance.getRegistration().getServiceUrl())\n\t\t\t\t.build();\n\t}\n\n\tprivate Mono<Void> sendWebhookNotification(NotificationPayload payload) {\n\t\treturn webClient.post()\n\t\t\t\t.uri(webhookUrl)\n\t\t\t\t.bodyValue(payload)\n\t\t\t\t.retrieve()\n\t\t\t\t.bodyToMono(Void.class)\n\t\t\t\t.doOnSuccess(v -> log.info("Webhook notification sent successfully"))\n\t\t\t\t.onErrorResume(ex -> {\n\t\t\t\t\tlog.error("Webhook call failed: {}", ex.getMessage());\n\t\t\t\t\treturn Mono.empty();\n\t\t\t\t});\n\t}\n\n\t@lombok.Data\n\t@lombok.Builder\n\tprivate static class NotificationPayload {\n\t\tprivate String instanceId;\n\t\tprivate String instanceName;\n\t\tprivate String eventType;\n\t\tprivate String status;\n\t\tprivate long timestamp;\n\t\tprivate String serviceUrl;\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'\n@Configuration\npublic class WebhookNotifierConfiguration {\n\n\t@Bean\n\tpublic WebhookNotifier webhookNotifier(InstanceRepository repository,\n\t\t\t\t\t\t\t\t\t\t   WebClient.Builder webClientBuilder,\n\t\t\t\t\t\t\t\t\t\t   @Value("${webhook.url}") String webhookUrl) {\n\t\treturn new WebhookNotifier(repository, webClientBuilder, webhookUrl);\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-yaml",metastring:'title="application.yml"',children:"webhook:\n  url: https://your-webhook-endpoint.com/notifications\n"})}),"\n",(0,o.jsx)(e.h2,{id:"filtering-events",children:"Filtering Events"}),"\n",(0,o.jsxs)(e.p,{children:["You can override ",(0,o.jsx)(e.code,{children:"shouldNotify"})," to filter which events trigger notifications:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class FilteredNotifier extends AbstractEventNotifier {\n\n\tpublic FilteredNotifier(InstanceRepository repository) {\n\t\tsuper(repository);\n\t}\n\n\t@Override\n\tprotected boolean shouldNotify(InstanceEvent event, Instance instance) {\n\t\t// Only notify for production instances\n\t\tString environment = instance.getRegistration()\n\t\t\t\t.getMetadata()\n\t\t\t\t.get("environment");\n\t\treturn "production".equals(environment);\n\t}\n\n\t@Override\n\tprotected Mono<Void> doNotify(InstanceEvent event, Instance instance) {\n\t\t// Send notification\n\t\treturn Mono.fromRunnable(() -> {\n\t\t\tlog.info("Production instance event: {}", event.getType());\n\t\t});\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"using-abstractstatuschangenotifier",children:"Using AbstractStatusChangeNotifier"}),"\n",(0,o.jsxs)(e.p,{children:["If you only care about status changes (UP/DOWN/OFFLINE), extend ",(0,o.jsx)(e.code,{children:"AbstractStatusChangeNotifier"}),":"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'import de.codecentric.boot.admin.server.domain.entities.Instance;\nimport de.codecentric.boot.admin.server.domain.entities.InstanceRepository;\nimport de.codecentric.boot.admin.server.domain.values.StatusInfo;\nimport de.codecentric.boot.admin.server.notify.AbstractStatusChangeNotifier;\n\nimport reactor.core.publisher.Mono;\n\npublic class StatusChangeNotifier extends AbstractStatusChangeNotifier {\n\n\tpublic StatusChangeNotifier(InstanceRepository repository) {\n\t\tsuper(repository);\n\t}\n\n\t@Override\n\tprotected Mono<Void> doNotify(InstanceEvent event, Instance instance) {\n\t\tStatusInfo statusInfo = instance.getStatusInfo();\n\t\tString status = statusInfo.getStatus();\n\n\t\treturn Mono.fromRunnable(() -> {\n\t\t\tif ("DOWN".equals(status)) {\n\t\t\t\t// Send critical alert\n\t\t\t\tlog.error("CRITICAL: Instance {} is DOWN!",\n\t\t\t\t\t\tinstance.getRegistration().getName());\n\t\t\t} else if ("UP".equals(status)) {\n\t\t\t\t// Send recovery notification\n\t\t\t\tlog.info("Instance {} is back UP",\n\t\t\t\t\t\tinstance.getRegistration().getName());\n\t\t\t}\n\t\t});\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"implementing-notifier-interface-directly",children:"Implementing Notifier Interface Directly"}),"\n",(0,o.jsxs)(e.p,{children:["For full control, implement the ",(0,o.jsx)(e.code,{children:"Notifier"})," interface:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"import de.codecentric.boot.admin.server.notify.Notifier;\n\nimport reactor.core.publisher.Mono;\n\npublic class DirectNotifier implements Notifier {\n\n\tprivate final InstanceRepository repository;\n\tprivate boolean enabled = true;\n\n\tpublic DirectNotifier(InstanceRepository repository) {\n\t\tthis.repository = repository;\n\t}\n\n\t@Override\n\tpublic Mono<Void> notify(InstanceEvent event) {\n\t\tif (!enabled) {\n\t\t\treturn Mono.empty();\n\t\t}\n\n\t\treturn repository.find(event.getInstance())\n\t\t\t\t.flatMap(instance -> processNotification(event, instance))\n\t\t\t\t.then();\n\t}\n\n\tprivate Mono<Void> processNotification(InstanceEvent event, Instance instance) {\n\t\t// Custom notification logic\n\t\treturn Mono.fromRunnable(() -> {\n\t\t\t// Send notification\n\t\t});\n\t}\n\n\tpublic void setEnabled(boolean enabled) {\n\t\tthis.enabled = enabled;\n\t}\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"configuration-properties",children:"Configuration Properties"}),"\n",(0,o.jsx)(e.p,{children:"Make your notifier configurable through application properties:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'import org.springframework.boot.context.properties.ConfigurationProperties;\n\n@ConfigurationProperties(prefix = "spring.boot.admin.notify.custom")\npublic class CustomNotifierProperties {\n\tprivate final boolean enabled = true;\n\tprivate String apiUrl;\n\tprivate String apiKey;\n\tprivate final int timeout = 5000;\n\n\t// Getters and setters\n}\n'})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'\n@Configuration\n@EnableConfigurationProperties(CustomNotifierProperties.class)\npublic class CustomNotifierConfiguration {\n\n\t@Bean\n\t@ConditionalOnProperty(prefix = "spring.boot.admin.notify.custom",\n\t\t\tname = "enabled",\n\t\t\thavingValue = "true",\n\t\t\tmatchIfMissing = true)\n\tpublic CustomNotifier customNotifier(InstanceRepository repository,\n\t\t\t\t\t\t\t\t\t\t CustomNotifierProperties properties) {\n\t\tCustomNotifier notifier = new CustomNotifier(repository);\n\t\tnotifier.setApiUrl(properties.getApiUrl());\n\t\tnotifier.setApiKey(properties.getApiKey());\n\t\tnotifier.setTimeout(properties.getTimeout());\n\t\treturn notifier;\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-yaml",metastring:'title="application.yml"',children:"spring:\n  boot:\n    admin:\n      notify:\n        custom:\n          enabled: true\n          api-url: https://api.example.com/notifications\n          api-key: ${NOTIFICATION_API_KEY}\n          timeout: 10000\n"})}),"\n",(0,o.jsx)(e.h2,{id:"combining-with-filteringnotifier",children:"Combining with FilteringNotifier"}),"\n",(0,o.jsxs)(e.p,{children:["Use ",(0,o.jsx)(e.code,{children:"FilteringNotifier"})," to allow runtime control:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'\n@Configuration\npublic class NotifierConfig {\n\n\t@Bean\n\tpublic FilteringNotifier filteringNotifier(InstanceRepository repository,\n\t\t\t\t\t\t\t\t\t\t\t   ObjectProvider<List<Notifier>> otherNotifiers) {\n\t\tCompositeNotifier delegate = new CompositeNotifier(\n\t\t\t\totherNotifiers.getIfAvailable(Collections::emptyList));\n\t\treturn new FilteringNotifier(delegate, repository);\n\t}\n\n\t@Primary\n\t@Bean(initMethod = "start", destroyMethod = "stop")\n\tpublic RemindingNotifier remindingNotifier(FilteringNotifier filteringNotifier,\n\t\t\t\t\t\t\t\t\t\t\t   InstanceRepository repository) {\n\t\tRemindingNotifier notifier = new RemindingNotifier(\n\t\t\t\tfilteringNotifier, repository);\n\t\tnotifier.setReminderPeriod(Duration.ofMinutes(10));\n\t\tnotifier.setCheckReminderInverval(Duration.ofSeconds(10));\n\t\treturn notifier;\n\t}\n\n\t@Bean\n\tpublic CustomNotifier customNotifier(InstanceRepository repository) {\n\t\treturn new CustomNotifier(repository);\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"testing-custom-notifiers",children:"Testing Custom Notifiers"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'import org.junit.jupiter.api.Test;\nimport org.mockito.Mockito;\nimport reactor.test.StepVerifier;\n\npublic class CustomNotifierTest {\n\n\t@Test\n\tpublic void testNotification() {\n\t\tInstanceRepository repository = Mockito.mock(InstanceRepository.class);\n\t\tCustomNotifier notifier = new CustomNotifier(repository);\n\n\t\tInstance instance = Instance.create(InstanceId.of("test-instance"))\n\t\t\t\t.register(Registration.create("test-app", "http://localhost:8080")\n\t\t\t\t\t\t.build());\n\n\t\tInstanceEvent event = new InstanceStatusChangedEvent(\n\t\t\t\tinstance.getId(),\n\t\t\t\tinstance.getVersion(),\n\t\t\t\tStatusInfo.ofUp()\n\t\t);\n\n\t\tMockito.when(repository.find(instance.getId()))\n\t\t\t\t.thenReturn(Mono.just(instance));\n\n\t\tStepVerifier.create(notifier.notify(event))\n\t\t\t\t.verifyComplete();\n\t}\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Extend AbstractEventNotifier"})," for most use cases - it provides essential features"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Handle errors gracefully"})," - don't let notification failures affect the server"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Use reactive programming"})," - return ",(0,o.jsx)(e.code,{children:"Mono<Void>"})," for async operations"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Make it configurable"})," - use ",(0,o.jsx)(e.code,{children:"@ConfigurationProperties"})," for flexibility"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Filter appropriately"})," - override ",(0,o.jsx)(e.code,{children:"shouldNotify"})," to reduce noise"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Log failures"})," - always log when notifications fail for debugging"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Use WebClient"})," for HTTP calls - it's reactive and efficient"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Consider rate limiting"})," - prevent notification storms"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Test thoroughly"})," - ensure your notifier handles all event types"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Document configuration"})," - provide clear examples for users"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"see-also",children:"See Also"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.a,{href:"/4.0.1/docs/server/notifications/",children:"Notifications Overview"})," - Learn about the notification system"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.a,{href:"/4.0.1/docs/server/notifications/#filtering-notifications",children:"Filtering Notifications"})," - Control which notifications are sent"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.a,{href:"/4.0.1/docs/server/notifications/#notification-reminder",children:"Notification Reminders"})," - Set up reminder notifications"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.a,{href:"/4.0.1/docs/server/Events",children:"Events"})," - Understand instance events"]}),"\n"]})]})}function f(t={}){const{wrapper:e}={...(0,r.R)(),...t.components};return e?(0,o.jsx)(e,{...t,children:(0,o.jsx)(d,{...t})}):d(t)}},8453:(t,e,n)=>{n.d(e,{R:()=>s,x:()=>a});var i=n(6540);const o={},r=i.createContext(o);function s(t){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function a(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(o):t.components||o:s(t.components),i.createElement(r.Provider,{value:e},t.children)}}}]);