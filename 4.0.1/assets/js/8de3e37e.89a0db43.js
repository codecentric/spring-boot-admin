"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[4887],{9116:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>g,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"customization/monitoring/instance-filters","title":"Instance Filters","description":"Filter which instances are visible and managed by Spring Boot Admin Server.","source":"@site/docs/06-customization/monitoring/01-instance-filters.md","sourceDirName":"06-customization/monitoring","slug":"/customization/monitoring/instance-filters","permalink":"/4.0.1/docs/customization/monitoring/instance-filters","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_custom_props":{"icon":"wrench"}},"sidebar":"sidebar","previous":{"title":"Customization","permalink":"/4.0.1/docs/customization/"},"next":{"title":"Custom Health Status","permalink":"/4.0.1/docs/customization/monitoring/custom-health-status"}}');var r=t(4848),s=t(8453);const a={sidebar_position:1,sidebar_custom_props:{icon:"wrench"}},l="Instance Filters",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Default Behavior",id:"default-behavior",level:2},{value:"InstanceFilter Interface",id:"instancefilter-interface",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Filter by Environment",id:"filter-by-environment",level:2},{value:"Filter by Tags",id:"filter-by-tags",level:2},{value:"Filter by Service Name",id:"filter-by-service-name",level:2},{value:"Filter by Status",id:"filter-by-status",level:2},{value:"Filter by URL Pattern",id:"filter-by-url-pattern",level:2},{value:"Configurable Filter",id:"configurable-filter",level:2},{value:"Multiple Conditions",id:"multiple-conditions",level:2},{value:"Advanced Filtering",id:"advanced-filtering",level:2},{value:"Filter by Registration Time",id:"filter-by-registration-time",level:3},{value:"Filter by Build Info",id:"filter-by-build-info",level:3},{value:"Database-Driven Filter",id:"database-driven-filter",level:3},{value:"Composite Filters",id:"composite-filters",level:2},{value:"Testing Filters",id:"testing-filters",level:2},{value:"Unit Test",id:"unit-test",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Issue: Instances not appearing in UI",id:"issue-instances-not-appearing-in-ui",level:3},{value:"Issue: Filter not applied",id:"issue-filter-not-applied",level:3},{value:"Issue: Metadata not available",id:"issue-metadata-not-available",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Examples",id:"examples",level:2},{value:"Example 1: Multi-Tenant Filter",id:"example-1-multi-tenant-filter",level:3},{value:"Example 2: Region-Based Filter",id:"example-2-region-based-filter",level:3},{value:"Example 3: Whitelist/Blacklist Filter",id:"example-3-whitelistblacklist-filter",level:3},{value:"See Also",id:"see-also",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"instance-filters",children:"Instance Filters"})}),"\n",(0,r.jsx)(e.p,{children:"Filter which instances are visible and managed by Spring Boot Admin Server."}),"\n",(0,r.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"InstanceFilter"})," allows you to selectively include or exclude instances from being displayed and monitored by the Admin\nServer."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Hide test/development instances in production Admin Server"}),"\n",(0,r.jsx)(e.li,{children:"Filter instances by environment, region, or tags"}),"\n",(0,r.jsx)(e.li,{children:"Exclude specific services from monitoring"}),"\n",(0,r.jsx)(e.li,{children:"Show only instances matching certain criteria"}),"\n"]}),"\n",(0,r.jsx)(e.mermaid,{value:'graph TD\n    A["Instances Registered<br/>\u2022 service-a (env=prod)<br/>\u2022 service-b (env=dev)<br/>\u2022 service-c (env=prod)<br/>\u2022 service-d (env=test)"] --\x3e B["InstanceFilter<br/>filter(instance) {<br/>  return \'prod\'.equals(<br/>    instance.getMetadata().get(\'env\')<br/>  );<br/>}"]\n    B --\x3e C["Visible Instances<br/>\u2022 service-a (env=prod)<br/>\u2022 service-c (env=prod)"]'}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"default-behavior",children:"Default Behavior"}),"\n",(0,r.jsxs)(e.p,{children:["By default, ",(0,r.jsx)(e.strong,{children:"all instances are visible"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"@Bean\n@ConditionalOnMissingBean\npublic InstanceFilter instanceFilter() {\n    return instance -> true;  // Accept all instances\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"instancefilter-interface",children:"InstanceFilter Interface"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"package de.codecentric.boot.admin.server.services;\n\nimport de.codecentric.boot.admin.server.domain.entities.Instance;\n\n@FunctionalInterface\npublic interface InstanceFilter {\n\n    /**\n     * Test if instance should be visible\n     * @param instance the instance to filter\n     * @return true if instance should be included, false to exclude\n     */\n    boolean filter(Instance instance);\n\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"InstanceFilter"})," is applied by ",(0,r.jsx)(e.code,{children:"InstanceRegistry"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"public Flux<Instance> getInstances() {\n    return repository.findAll().filter(filter::filter);\n}\n\npublic Mono<Instance> getInstance(InstanceId id) {\n    return repository.find(id).filter(filter::filter);\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Important"}),": Instances are ",(0,r.jsx)(e.strong,{children:"still stored"})," in the repository, but filtered from queries. This means:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Filtered instances continue to be monitored"}),"\n",(0,r.jsx)(e.li,{children:"Events are still generated for filtered instances"}),"\n",(0,r.jsx)(e.li,{children:"Filtering only affects visibility in the UI and API"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"filter-by-environment",children:"Filter by Environment"}),"\n",(0,r.jsx)(e.p,{children:"Show only production instances:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        return instance -> {\n            String env = instance.getRegistration()\n                .getMetadata()\n                .get("environment");\n\n            return "production".equals(env);\n        };\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Client Configuration"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          metadata:\n            environment: production\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"filter-by-tags",children:"Filter by Tags"}),"\n",(0,r.jsx)(e.p,{children:"Show only instances with specific tags:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        return instance -> {\n            String tags = instance.getRegistration()\n                .getMetadata()\n                .get("tags");\n\n            if (tags == null) {\n                return false;  // Exclude instances without tags\n            }\n\n            // Show instances with "production" or "critical" tag\n            return tags.contains("production") || tags.contains("critical");\n        };\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Client Configuration"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          metadata:\n            tags: production,critical,payment\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"filter-by-service-name",children:"Filter by Service Name"}),"\n",(0,r.jsx)(e.p,{children:"Exclude specific services:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport java.util.Set;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        Set<String> excludedServices = Set.of(\n            "test-service",\n            "dev-helper",\n            "mock-service"\n        );\n\n        return instance -> {\n            String serviceName = instance.getRegistration().getName();\n            return !excludedServices.contains(serviceName);\n        };\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"filter-by-status",children:"Filter by Status"}),"\n",(0,r.jsx)(e.p,{children:"Show only healthy instances:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"package com.example.admin;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.domain.values.StatusInfo;\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        return instance -> {\n            StatusInfo status = instance.getStatusInfo();\n\n            // Show only UP or UNKNOWN instances\n            return status.isUp() || status.isUnknown();\n        };\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Status values"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"isUp()"})," - Instance is healthy"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"isDown()"})," - Instance is unhealthy"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"isOffline()"})," - Instance is unreachable"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"isUnknown()"})," - Status not yet determined"]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"filter-by-url-pattern",children:"Filter by URL Pattern"}),"\n",(0,r.jsx)(e.p,{children:"Show only instances from specific hosts:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        return instance -> {\n            String serviceUrl = instance.getRegistration().getServiceUrl();\n\n            // Show only instances on production domain\n            return serviceUrl != null &&\n                   serviceUrl.contains(".prod.company.com");\n        };\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"configurable-filter",children:"Configurable Filter"}),"\n",(0,r.jsx)(e.p,{children:"Filter based on application properties:"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"application.yml"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"admin:\n  filter:\n    enabled: true\n    environment: production\n    tags:\n      - critical\n      - production\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Configuration"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport java.util.List;\n\nimport org.springframework.boot.context.properties.ConfigurationProperties;\nimport org.springframework.boot.context.properties.EnableConfigurationProperties;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.stereotype.Component;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\n@EnableConfigurationProperties(FilterProperties.class)\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter(FilterProperties filterProperties) {\n        if (!filterProperties.isEnabled()) {\n            return instance -> true;  // No filtering\n        }\n\n        return instance -> {\n            String env = instance.getRegistration()\n                .getMetadata()\n                .get("environment");\n\n            String tags = instance.getRegistration()\n                .getMetadata()\n                .get("tags");\n\n            // Check environment\n            if (filterProperties.getEnvironment() != null) {\n                if (!filterProperties.getEnvironment().equals(env)) {\n                    return false;\n                }\n            }\n\n            // Check tags\n            if (filterProperties.getTags() != null && !filterProperties.getTags().isEmpty()) {\n                if (tags == null) {\n                    return false;\n                }\n\n                for (String requiredTag : filterProperties.getTags()) {\n                    if (tags.contains(requiredTag)) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n\n            return true;\n        };\n    }\n}\n\n@Component\n@ConfigurationProperties(prefix = "admin.filter")\nclass FilterProperties {\n    private boolean enabled = false;\n    private String environment;\n    private List<String> tags;\n\n    // Getters and setters\n    public boolean isEnabled() {\n        return enabled;\n    }\n\n    public void setEnabled(boolean enabled) {\n        this.enabled = enabled;\n    }\n\n    public String getEnvironment() {\n        return environment;\n    }\n\n    public void setEnvironment(String environment) {\n        this.environment = environment;\n    }\n\n    public List<String> getTags() {\n        return tags;\n    }\n\n    public void setTags(List<String> tags) {\n        this.tags = tags;\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"multiple-conditions",children:"Multiple Conditions"}),"\n",(0,r.jsx)(e.p,{children:"Combine multiple filter conditions:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport java.util.Set;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        Set<String> allowedEnvironments = Set.of("production", "staging");\n        Set<String> excludedServices = Set.of("test-service", "dev-tool");\n\n        return instance -> {\n            String env = instance.getRegistration()\n                .getMetadata()\n                .get("environment");\n\n            String serviceName = instance.getRegistration().getName();\n\n            // Include if:\n            // 1. Environment is allowed AND\n            // 2. Service is not excluded\n            return allowedEnvironments.contains(env) &&\n                   !excludedServices.contains(serviceName);\n        };\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"advanced-filtering",children:"Advanced Filtering"}),"\n",(0,r.jsx)(e.h3,{id:"filter-by-registration-time",children:"Filter by Registration Time"}),"\n",(0,r.jsx)(e.p,{children:"Show only recently registered instances:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"package com.example.admin;\n\nimport java.time.Duration;\nimport java.time.Instant;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        return instance -> {\n            Instant registrationTime = instance.getRegistration().getTimestamp();\n            if (registrationTime == null) {\n                return true;\n            }\n\n            // Show instances registered within last 7 days\n            Duration age = Duration.between(registrationTime, Instant.now());\n            return age.compareTo(Duration.ofDays(7)) < 0;\n        };\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"filter-by-build-info",children:"Filter by Build Info"}),"\n",(0,r.jsx)(e.p,{children:"Show only instances with specific versions:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        return instance -> {\n            if (instance.getInfo() == null || instance.getInfo().getValues() == null) {\n                return true;  // No build info available\n            }\n\n            Object buildInfo = instance.getInfo().getValues().get("build");\n            if (buildInfo instanceof Map) {\n                Map<?, ?> build = (Map<?, ?>) buildInfo;\n                String version = (String) build.get("version");\n\n                // Only show version 2.x and above\n                return version != null && !version.startsWith("1.");\n            }\n\n            return true;\n        };\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"database-driven-filter",children:"Database-Driven Filter"}),"\n",(0,r.jsx)(e.p,{children:"Load filter rules from database:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter(InstanceFilterRuleRepository repository) {\n        return instance -> {\n            String serviceName = instance.getRegistration().getName();\n            String env = instance.getRegistration()\n                .getMetadata()\n                .get("environment");\n\n            // Query database for filter rules\n            return repository.shouldShowInstance(serviceName, env);\n        };\n    }\n}\n\ninterface InstanceFilterRuleRepository {\n    boolean shouldShowInstance(String serviceName, String environment);\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"composite-filters",children:"Composite Filters"}),"\n",(0,r.jsx)(e.p,{children:"Combine multiple filters with AND/OR logic:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport java.util.Arrays;\nimport java.util.List;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\n@Configuration\npublic class InstanceFilterConfig {\n\n    @Bean\n    public InstanceFilter instanceFilter() {\n        InstanceFilter envFilter = instance -> {\n            String env = instance.getRegistration()\n                .getMetadata()\n                .get("environment");\n            return "production".equals(env);\n        };\n\n        InstanceFilter statusFilter = instance -> {\n            return instance.getStatusInfo().isUp();\n        };\n\n        InstanceFilter tagsFilter = instance -> {\n            String tags = instance.getRegistration()\n                .getMetadata()\n                .get("tags");\n            return tags != null && tags.contains("monitored");\n        };\n\n        // Combine with AND logic\n        return and(envFilter, statusFilter, tagsFilter);\n    }\n\n    private InstanceFilter and(InstanceFilter... filters) {\n        return instance -> {\n            for (InstanceFilter filter : filters) {\n                if (!filter.filter(instance)) {\n                    return false;\n                }\n            }\n            return true;\n        };\n    }\n\n    private InstanceFilter or(InstanceFilter... filters) {\n        return instance -> {\n            for (InstanceFilter filter : filters) {\n                if (filter.filter(instance)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"testing-filters",children:"Testing Filters"}),"\n",(0,r.jsx)(e.h3,{id:"unit-test",children:"Unit Test"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.admin;\n\nimport java.util.Map;\n\nimport org.junit.jupiter.api.Test;\n\nimport de.codecentric.boot.admin.server.domain.entities.Instance;\nimport de.codecentric.boot.admin.server.domain.values.InstanceId;\nimport de.codecentric.boot.admin.server.domain.values.Registration;\nimport de.codecentric.boot.admin.server.services.InstanceFilter;\n\nimport static org.assertj.core.api.Assertions.assertThat;\n\nclass InstanceFilterTest {\n\n    @Test\n    void shouldFilterByEnvironment() {\n        InstanceFilter filter = instance -> {\n            String env = instance.getRegistration()\n                .getMetadata()\n                .get("environment");\n            return "production".equals(env);\n        };\n\n        Instance prodInstance = createInstance("prod-service",\n            Map.of("environment", "production"));\n        Instance devInstance = createInstance("dev-service",\n            Map.of("environment", "development"));\n\n        assertThat(filter.filter(prodInstance)).isTrue();\n        assertThat(filter.filter(devInstance)).isFalse();\n    }\n\n    private Instance createInstance(String name, Map<String, String> metadata) {\n        Registration registration = Registration.builder()\n            .name(name)\n            .healthUrl("http://localhost:8080/actuator/health")\n            .metadata(metadata)\n            .build();\n\n        return Instance.create(InstanceId.of("test-id"))\n            .register(registration);\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(e.h3,{id:"issue-instances-not-appearing-in-ui",children:"Issue: Instances not appearing in UI"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Cause"}),": Filter is excluding them."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Debug"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'@Bean\npublic InstanceFilter instanceFilter() {\n    return instance -> {\n        boolean result = /* your filter logic */;\n\n        // Log for debugging\n        if (!result) {\n            System.out.println("Filtered out: " +\n                instance.getRegistration().getName());\n        }\n\n        return result;\n    };\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"issue-filter-not-applied",children:"Issue: Filter not applied"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Cause"}),": Multiple ",(0,r.jsx)(e.code,{children:"InstanceFilter"})," beans defined."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Solution"}),": Only define one ",(0,r.jsx)(e.code,{children:"InstanceFilter"})," bean. Spring Boot Admin uses the first one it finds."]}),"\n",(0,r.jsx)(e.h3,{id:"issue-metadata-not-available",children:"Issue: Metadata not available"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Cause"}),": Client not sending metadata."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Solution"}),": Verify client configuration:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          metadata:\n            environment: production\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Keep filters simple"}),": Complex filters can impact performance"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Document filter logic"}),": Make it clear why instances are excluded"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Test thoroughly"}),": Ensure correct instances are visible"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Use metadata"}),": Don't filter based on volatile data like status"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Consider multiple Admin Servers"}),": Instead of complex filtering, run separate Admin Servers for different\nenvironments"]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(e.h3,{id:"example-1-multi-tenant-filter",children:"Example 1: Multi-Tenant Filter"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'@Bean\npublic InstanceFilter instanceFilter(@Value("${tenant.id}") String tenantId) {\n    return instance -> {\n        String instanceTenant = instance.getRegistration()\n            .getMetadata()\n            .get("tenant");\n        return tenantId.equals(instanceTenant);\n    };\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"example-2-region-based-filter",children:"Example 2: Region-Based Filter"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'@Bean\npublic InstanceFilter instanceFilter(@Value("${aws.region}") String currentRegion) {\n    return instance -> {\n        String instanceRegion = instance.getRegistration()\n            .getMetadata()\n            .get("region");\n        return currentRegion.equals(instanceRegion);\n    };\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"example-3-whitelistblacklist-filter",children:"Example 3: Whitelist/Blacklist Filter"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'@Bean\npublic InstanceFilter instanceFilter(\n        @Value("${admin.whitelist:}") List<String> whitelist,\n        @Value("${admin.blacklist:}") List<String> blacklist) {\n\n    return instance -> {\n        String serviceName = instance.getRegistration().getName();\n\n        // Blacklist takes precedence\n        if (blacklist.contains(serviceName)) {\n            return false;\n        }\n\n        // If whitelist is empty, allow all (except blacklisted)\n        if (whitelist.isEmpty()) {\n            return true;\n        }\n\n        // Otherwise, only allow whitelisted\n        return whitelist.contains(serviceName);\n    };\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Configuration"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"admin:\n  whitelist:\n    - payment-service\n    - user-service\n  blacklist:\n    - test-service\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/4.0.1/docs/server/server",children:"Server Configuration"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/4.0.1/docs/customization/monitoring/custom-health-status",children:"Custom Health Status"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/4.0.1/docs/customization/server/endpoint-detection",children:"Endpoint Detection"})}),"\n"]})]})}function g(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>l});var i=t(6540);const r={},s=i.createContext(r);function a(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);