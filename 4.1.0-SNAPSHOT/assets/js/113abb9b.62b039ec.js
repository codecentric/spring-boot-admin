"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[8424],{7979:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"samples/sample-hazelcast","title":"Hazelcast Sample","description":"Clustered Spring Boot Admin Server deployment using Hazelcast for distributed event storage. This sample demonstrates","source":"@site/docs/09-samples/60-sample-hazelcast.md","sourceDirName":"09-samples","slug":"/samples/sample-hazelcast","permalink":"/4.1.0-SNAPSHOT/docs/samples/sample-hazelcast","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":60,"frontMatter":{"sidebar_position":60,"sidebar_custom_props":{"icon":"file-code"}},"sidebar":"sidebar","previous":{"title":"Zookeeper Sample","permalink":"/4.1.0-SNAPSHOT/docs/samples/sample-zookeeper"},"next":{"title":"Custom UI Sample","permalink":"/4.1.0-SNAPSHOT/docs/samples/sample-custom-ui"}}');var t=i(4848),l=i(8453);const a={sidebar_position:60,sidebar_custom_props:{icon:"file-code"}},r="Hazelcast Sample",c={},o=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Running Multiple Instances",id:"running-multiple-instances",level:2},{value:"Terminal 1 (Port 8080)",id:"terminal-1-port-8080",level:3},{value:"Terminal 2 (Port 8081)",id:"terminal-2-port-8081",level:3},{value:"Terminal 3 (Port 8082)",id:"terminal-3-port-8082",level:3},{value:"Dependencies",id:"dependencies",level:2},{value:"Hazelcast Configuration",id:"hazelcast-configuration",level:2},{value:"How Clustering Works",id:"how-clustering-works",level:2},{value:"Event Synchronization",id:"event-synchronization",level:3},{value:"Notification Deduplication",id:"notification-deduplication",level:3},{value:"Load Balancing",id:"load-balancing",level:3},{value:"Testing Clustering",id:"testing-clustering",level:2},{value:"Verify Cluster Formation",id:"verify-cluster-formation",level:3},{value:"Test Event Sharing",id:"test-event-sharing",level:3},{value:"Test High Availability",id:"test-high-availability",level:3},{value:"Production Configuration",id:"production-configuration",level:2},{value:"Multicast Discovery",id:"multicast-discovery",level:3},{value:"TCP/IP with Multiple Hosts",id:"tcpip-with-multiple-hosts",level:3},{value:"Kubernetes Discovery",id:"kubernetes-discovery",level:3},{value:"Monitoring Hazelcast",id:"monitoring-hazelcast",level:2},{value:"JMX",id:"jmx",level:3},{value:"Hazelcast Management Center",id:"hazelcast-management-center",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"hazelcast-sample",children:"Hazelcast Sample"})}),"\n",(0,t.jsx)(n.p,{children:"Clustered Spring Boot Admin Server deployment using Hazelcast for distributed event storage. This sample demonstrates\nhigh-availability setup where multiple Admin Server instances share state via Hazelcast."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Location"}),": ",(0,t.jsx)(n.code,{children:"spring-boot-admin-samples/spring-boot-admin-sample-hazelcast/"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Features"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Distributed event store with Hazelcast"}),"\n",(0,t.jsx)(n.li,{children:"Multi-instance clustering"}),"\n",(0,t.jsx)(n.li,{children:"Shared notification state"}),"\n",(0,t.jsx)(n.li,{children:"High availability"}),"\n",(0,t.jsx)(n.li,{children:"TCP/IP cluster discovery"}),"\n",(0,t.jsx)(n.li,{children:"JMX monitoring enabled"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Java 17+, Maven 3.6+"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"running-multiple-instances",children:"Running Multiple Instances"}),"\n",(0,t.jsx)(n.h3,{id:"terminal-1-port-8080",children:"Terminal 1 (Port 8080)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd spring-boot-admin-samples/spring-boot-admin-sample-hazelcast\nmvn spring-boot:run\n"})}),"\n",(0,t.jsx)(n.h3,{id:"terminal-2-port-8081",children:"Terminal 2 (Port 8081)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"SERVER_PORT=8081 mvn spring-boot:run\n"})}),"\n",(0,t.jsx)(n.h3,{id:"terminal-3-port-8082",children:"Terminal 3 (Port 8082)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"SERVER_PORT=8082 mvn spring-boot:run\n"})}),"\n",(0,t.jsx)(n.p,{children:"All instances automatically form a cluster and share:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Instance events"}),"\n",(0,t.jsx)(n.li,{children:"Notification state"}),"\n",(0,t.jsx)(n.li,{children:"Application registry"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>de.codecentric</groupId>\n    <artifactId>spring-boot-admin-starter-server</artifactId>\n</dependency>\n<dependency>\n    <groupId>de.codecentric</groupId>\n    <artifactId>spring-boot-admin-starter-client</artifactId>\n</dependency>\n<dependency>\n    <groupId>com.hazelcast</groupId>\n    <artifactId>hazelcast</artifactId>\n</dependency>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"hazelcast-configuration",children:"Hazelcast Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Bean\npublic Config hazelcastConfig() {\n    // Event store map - holds all instance events\n    MapConfig eventStoreMap = new MapConfig(DEFAULT_NAME_EVENT_STORE_MAP)\n        .setInMemoryFormat(InMemoryFormat.OBJECT)\n        .setBackupCount(1)  // 1 backup copy\n        .setMergePolicyConfig(\n            new MergePolicyConfig(PutIfAbsentMergePolicy.class.getName(), 100)\n        );\n\n    // Notification map - deduplicates notifications\n    MapConfig sentNotificationsMap = new MapConfig(DEFAULT_NAME_SENT_NOTIFICATIONS_MAP)\n        .setInMemoryFormat(InMemoryFormat.OBJECT)\n        .setBackupCount(1)\n        .setEvictionConfig(\n            new EvictionConfig()\n                .setEvictionPolicy(EvictionPolicy.LRU)\n                .setMaxSizePolicy(MaxSizePolicy.PER_NODE)\n        );\n\n    Config config = new Config();\n    config.addMapConfig(eventStoreMap);\n    config.addMapConfig(sentNotificationsMap);\n    config.setProperty("hazelcast.jmx", "true");\n\n    // TCP/IP cluster discovery (local)\n    config.getNetworkConfig().getJoin().getMulticastConfig().setEnabled(false);\n    TcpIpConfig tcpIpConfig = config.getNetworkConfig()\n        .getJoin()\n        .getTcpIpConfig();\n    tcpIpConfig.setEnabled(true);\n    tcpIpConfig.setMembers(singletonList("127.0.0.1"));\n\n    return config;\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Configuration Details"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event Store"}),": Reliable storage with 1 backup"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sent Notifications"}),": LRU eviction to prevent memory growth"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cluster"}),": TCP/IP discovery on localhost"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"JMX"}),": Enabled for monitoring"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"how-clustering-works",children:"How Clustering Works"}),"\n",(0,t.jsx)(n.h3,{id:"event-synchronization",children:"Event Synchronization"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Instance A receives status change event"}),"\n",(0,t.jsx)(n.li,{children:"Event stored in Hazelcast distributed map"}),"\n",(0,t.jsx)(n.li,{children:"Instances B and C immediately see the event"}),"\n",(0,t.jsx)(n.li,{children:"All instances update their local state"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"notification-deduplication",children:"Notification Deduplication"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Instance A sends notification"}),"\n",(0,t.jsx)(n.li,{children:"Records in Hazelcast sent-notifications map"}),"\n",(0,t.jsx)(n.li,{children:"Instance B sees event, checks sent-notifications"}),"\n",(0,t.jsx)(n.li,{children:"B skips sending (already sent by A)"}),"\n",(0,t.jsx)(n.li,{children:"No duplicate notifications to users"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"load-balancing",children:"Load Balancing"}),"\n",(0,t.jsx)(n.mermaid,{value:"graph TD\n    LB[Load Balancer] --\x3e A[Admin 8080]\n    LB --\x3e B[Admin 8081]\n    LB --\x3e C[Admin 8082]\n    A -.-> HC[Hazelcast Cluster]\n    B -.-> HC\n    C -.-> HC"}),"\n",(0,t.jsx)(n.p,{children:"Users can connect to any instance - they all show the same data."}),"\n",(0,t.jsx)(n.h2,{id:"testing-clustering",children:"Testing Clustering"}),"\n",(0,t.jsx)(n.h3,{id:"verify-cluster-formation",children:"Verify Cluster Formation"}),"\n",(0,t.jsx)(n.p,{children:"Check logs for:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Members {size:3, ver:3} [\n    Member [127.0.0.1]:5701 - e1f2g3h4\n    Member [127.0.0.1]:5702 - a5b6c7d8\n    Member [127.0.0.1]:5703 - i9j0k1l2\n]\n"})}),"\n",(0,t.jsx)(n.h3,{id:"test-event-sharing",children:"Test Event Sharing"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Register application on instance 8080"}),"\n",(0,t.jsx)(n.li,{children:"Check instance 8081 - application appears"}),"\n",(0,t.jsx)(n.li,{children:"Stop instance 8080"}),"\n",(0,t.jsx)(n.li,{children:"Application still visible on 8081"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"test-high-availability",children:"Test High Availability"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Start 3 instances"}),"\n",(0,t.jsx)(n.li,{children:"Stop instance 8080"}),"\n",(0,t.jsx)(n.li,{children:"Instances 8081 and 8082 continue operating"}),"\n",(0,t.jsx)(n.li,{children:"All data preserved (1 backup)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"production-configuration",children:"Production Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"multicast-discovery",children:"Multicast Discovery"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'config.getNetworkConfig()\n    .getJoin()\n    .getMulticastConfig()\n    .setEnabled(true)\n    .setMulticastGroup("224.2.2.3")\n    .setMulticastPort(54327);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"tcpip-with-multiple-hosts",children:"TCP/IP with Multiple Hosts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'tcpIpConfig.setMembers(Arrays.asList(\n    "admin-1.company.com",\n    "admin-2.company.com",\n    "admin-3.company.com"\n));\n'})}),"\n",(0,t.jsx)(n.h3,{id:"kubernetes-discovery",children:"Kubernetes Discovery"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'config.getNetworkConfig()\n    .getJoin()\n    .getKubernetesConfig()\n    .setEnabled(true)\n    .setProperty("namespace", "default")\n    .setProperty("service-name", "spring-boot-admin");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"monitoring-hazelcast",children:"Monitoring Hazelcast"}),"\n",(0,t.jsx)(n.h3,{id:"jmx",children:"JMX"}),"\n",(0,t.jsx)(n.p,{children:"Enable JMX and connect with JConsole:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"jconsole\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Look for ",(0,t.jsx)(n.code,{children:"com.hazelcast"})," MBeans."]}),"\n",(0,t.jsx)(n.h3,{id:"hazelcast-management-center",children:"Hazelcast Management Center"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run -p 8080:8080 hazelcast/management-center\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Connect to: ",(0,t.jsx)(n.code,{children:"http://localhost:8080"})]}),"\n",(0,t.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,t.jsxs)(n.p,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"High Availability"}),": No single point of failure",(0,t.jsx)(n.br,{}),"\n","\u2705 ",(0,t.jsx)(n.strong,{children:"Horizontal Scaling"}),": Add instances dynamically",(0,t.jsx)(n.br,{}),"\n","\u2705 ",(0,t.jsx)(n.strong,{children:"Shared State"}),": All instances synchronized",(0,t.jsx)(n.br,{}),"\n","\u2705 ",(0,t.jsx)(n.strong,{children:"Enterprise Features"}),": Backup, eviction, merge policies"]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/4.1.0-SNAPSHOT/docs/integration/hazelcast",children:"Hazelcast Integration Guide"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/4.1.0-SNAPSHOT/docs/samples/sample-servlet",children:"Servlet Sample"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/4.1.0-SNAPSHOT/docs/samples/sample-custom-ui",children:"Custom UI Sample"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.hazelcast.com/",children:"Hazelcast Documentation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/4.1.0-SNAPSHOT/docs/integration/hazelcast",children:"Clustering"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/4.1.0-SNAPSHOT/docs/server/server",children:"Server Configuration"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var s=i(6540);const t={},l=s.createContext(t);function a(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);