"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[9981],{3589:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"client/registration","title":"Application Registration","description":"The Spring Boot Admin Client handles the registration of your application with the Admin Server through the","source":"@site/docs/03-client/20-registration.md","sourceDirName":"03-client","slug":"/client/registration","permalink":"/4.0.0/docs/client/registration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20,"sidebar_custom_props":{"icon":"link"}},"sidebar":"sidebar","previous":{"title":"Features","permalink":"/4.0.0/docs/client/client-features"},"next":{"title":"Metadata and Tags","permalink":"/4.0.0/docs/client/metadata"}}');var r=i(4848),a=i(8453);const l={sidebar_position:20,sidebar_custom_props:{icon:"link"}},s="Application Registration",c={},o=[{value:"ApplicationRegistrator",id:"applicationregistrator",level:2},{value:"Default Implementation",id:"default-implementation",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Registration Process",id:"registration-process",level:3},{value:"ApplicationFactory",id:"applicationfactory",level:2},{value:"Default Implementation: DefaultApplicationFactory",id:"default-implementation-defaultapplicationfactory",level:3},{value:"Application Properties",id:"application-properties",level:3},{value:"Name",id:"name",level:4},{value:"Service URL",id:"service-url",level:4},{value:"Management URL",id:"management-url",level:4},{value:"Health URL",id:"health-url",level:4},{value:"Host Type",id:"host-type",level:3},{value:"Custom ApplicationFactory",id:"custom-applicationfactory",level:3},{value:"Specialized ApplicationFactories",id:"specialized-applicationfactories",level:2},{value:"Servlet ApplicationFactory",id:"servlet-applicationfactory",level:3},{value:"Reactive ApplicationFactory",id:"reactive-applicationfactory",level:3},{value:"Cloud Foundry ApplicationFactory",id:"cloud-foundry-applicationfactory",level:3},{value:"Application Class",id:"application-class",level:2},{value:"Building an Application",id:"building-an-application",level:3},{value:"Registration Lifecycle Events",id:"registration-lifecycle-events",level:2},{value:"Custom Registrator",id:"custom-registrator",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Registration Fails",id:"registration-fails",level:3},{value:"Instance Not Appearing",id:"instance-not-appearing",level:3},{value:"Repeated Re-registrations",id:"repeated-re-registrations",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"application-registration",children:"Application Registration"})}),"\n",(0,r.jsxs)(n.p,{children:["The Spring Boot Admin Client handles the registration of your application with the Admin Server through the\n",(0,r.jsx)(n.code,{children:"ApplicationRegistrator"})," and ",(0,r.jsx)(n.code,{children:"ApplicationFactory"})," interfaces."]}),"\n",(0,r.jsx)(n.h2,{id:"applicationregistrator",children:"ApplicationRegistrator"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"ApplicationRegistrator"})," is responsible for managing the registration lifecycle:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public interface ApplicationRegistrator {\n\n    /**\n     * Registers the client application at spring-boot-admin-server.\n     * @return true if successful registration on at least one admin server\n     */\n    boolean register();\n\n    /**\n     * Tries to deregister currently registered application\n     */\n    void deregister();\n\n    /**\n     * @return the id of this client as given by the admin server.\n     * Returns null if not registered yet.\n     */\n    String getRegisteredId();\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"default-implementation",children:"Default Implementation"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"DefaultApplicationRegistrator"})," automatically handles:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initial registration on application startup"}),"\n",(0,r.jsx)(n.li,{children:"Periodic re-registration (heartbeat)"}),"\n",(0,r.jsx)(n.li,{children:"Automatic deregistration on shutdown"}),"\n",(0,r.jsx)(n.li,{children:"Retry logic for failed registrations"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="application.yml"',children:"spring:\n  boot:\n    admin:\n      client:\n        url: http://localhost:8080  # Admin Server URL\n        period: 10000  # Registration interval in milliseconds\n        auto-registration: true  # Enable auto-registration\n        auto-deregistration: true  # Enable auto-deregistration on shutdown\n"})}),"\n",(0,r.jsx)(n.h3,{id:"registration-process",children:"Registration Process"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Application Startup"}),": The ",(0,r.jsx)(n.code,{children:"RegistrationApplicationListener"})," triggers registration when ",(0,r.jsx)(n.code,{children:"WebServerInitializedEvent"}),"\nis fired"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create Application"}),": ",(0,r.jsx)(n.code,{children:"ApplicationFactory"})," creates the registration payload"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"HTTP POST"}),": Client sends POST request to ",(0,r.jsx)(n.code,{children:"/instances"})," endpoint"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Receive ID"}),": Server responds with an instance ID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Periodic Heartbeat"}),": Client re-registers at configured intervals"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Shutdown Hook"}),": Application deregisters on graceful shutdown"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"applicationfactory",children:"ApplicationFactory"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"ApplicationFactory"})," is responsible for creating the ",(0,r.jsx)(n.code,{children:"Application"})," object that contains all registration\ninformation."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public interface ApplicationFactory {\n    Application createApplication();\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"default-implementation-defaultapplicationfactory",children:"Default Implementation: DefaultApplicationFactory"}),"\n",(0,r.jsx)(n.p,{children:"The default factory gathers information from:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"InstanceProperties"})," - Client configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ServerProperties"})," - Web server configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ManagementServerProperties"})," - Actuator configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PathMappedEndpoints"})," - Actuator endpoint mappings"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MetadataContributor"})," - Custom metadata"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@Override\npublic Application createApplication() {\n    return Application.create(getName())\n        .healthUrl(getHealthUrl())\n        .managementUrl(getManagementUrl())\n        .serviceUrl(getServiceUrl())\n        .metadata(getMetadata())\n        .build();\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"application-properties",children:"Application Properties"}),"\n",(0,r.jsx)(n.h4,{id:"name",children:"Name"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          name: ${spring.application.name}  # Application name\n"})}),"\n",(0,r.jsx)(n.h4,{id:"service-url",children:"Service URL"}),"\n",(0,r.jsx)(n.p,{children:"The URL where your application can be accessed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          service-url: https://my-app.example.com\n          # or let it auto-detect:\n          service-base-url: https://my-app.example.com\n          service-path: /\n"})}),"\n",(0,r.jsx)(n.p,{children:"Auto-detection uses:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Configured ",(0,r.jsx)(n.code,{children:"service-url"})," (highest priority)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"service-base-url"})," + ",(0,r.jsx)(n.code,{children:"service-path"})]}),"\n",(0,r.jsx)(n.li,{children:"Auto-detected from server properties"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"management-url",children:"Management URL"}),"\n",(0,r.jsx)(n.p,{children:"URL for actuator endpoints:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          management-url: https://my-app.example.com/actuator\n          # or\n          management-base-url: https://my-app.example.com\nmanagement:\n  endpoints:\n    web:\n      base-path: /actuator\n"})}),"\n",(0,r.jsx)(n.h4,{id:"health-url",children:"Health URL"}),"\n",(0,r.jsx)(n.p,{children:"Specific health endpoint URL:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          health-url: https://my-app.example.com/actuator/health\n"})}),"\n",(0,r.jsx)(n.h3,{id:"host-type",children:"Host Type"}),"\n",(0,r.jsx)(n.p,{children:"Control how the service host is determined:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        instance:\n          service-host-type: IP  # or CANONICAL\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"IP"})}),": Use the IP address"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"CANONICAL"})}),": Use the canonical hostname"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"custom-applicationfactory",children:"Custom ApplicationFactory"}),"\n",(0,r.jsx)(n.p,{children:"Create a custom factory for specialized registration logic:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Component\npublic class CustomApplicationFactory implements ApplicationFactory {\n\n    private final InstanceProperties instance;\n    private final Environment environment;\n\n    public CustomApplicationFactory(InstanceProperties instance,\n                                   Environment environment) {\n        this.instance = instance;\n        this.environment = environment;\n    }\n\n    @Override\n    public Application createApplication() {\n        Map<String, String> metadata = new HashMap<>();\n        metadata.put("environment", environment.getProperty("app.environment"));\n        metadata.put("version", environment.getProperty("app.version"));\n        metadata.put("region", environment.getProperty("cloud.region"));\n\n        return Application.create(instance.getName())\n            .healthUrl(buildHealthUrl())\n            .managementUrl(buildManagementUrl())\n            .serviceUrl(buildServiceUrl())\n            .metadata(metadata)\n            .build();\n    }\n\n    private String buildHealthUrl() {\n        // Custom logic to build health URL\n        return "https://my-app.com/health";\n    }\n\n    private String buildManagementUrl() {\n        // Custom logic to build management URL\n        return "https://my-app.com/management";\n    }\n\n    private String buildServiceUrl() {\n        // Custom logic to build service URL\n        return "https://my-app.com";\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"specialized-applicationfactories",children:"Specialized ApplicationFactories"}),"\n",(0,r.jsx)(n.h3,{id:"servlet-applicationfactory",children:"Servlet ApplicationFactory"}),"\n",(0,r.jsx)(n.p,{children:"For servlet-based applications:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class ServletApplicationFactory extends DefaultApplicationFactory {\n    // Detects servlet port and context path automatically\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"reactive-applicationfactory",children:"Reactive ApplicationFactory"}),"\n",(0,r.jsx)(n.p,{children:"For WebFlux applications:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class ReactiveApplicationFactory extends DefaultApplicationFactory {\n    // Detects Netty port and context automatically\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cloud-foundry-applicationfactory",children:"Cloud Foundry ApplicationFactory"}),"\n",(0,r.jsx)(n.p,{children:"For Cloud Foundry deployments:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class CloudFoundryApplicationFactory implements ApplicationFactory {\n    // Uses CF-specific environment variables:\n    // - vcap.application.application_id\n    // - vcap.application.instance_id\n    // - vcap.application.uris\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Automatically activated when Cloud Foundry is detected."}),"\n",(0,r.jsx)(n.h2,{id:"application-class",children:"Application Class"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"Application"})," class represents the registration payload:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class Application {\n    private final String name;\n    private final String managementUrl;\n    private final String healthUrl;\n    private final String serviceUrl;\n    private final Map<String, String> metadata;\n\n    // Builder pattern\n    public static Builder create(String name) {\n        return new Builder(name);\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"building-an-application",children:"Building an Application"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'Application app = Application.create("my-application")\n    .healthUrl("http://localhost:8080/actuator/health")\n    .managementUrl("http://localhost:8080/actuator")\n    .serviceUrl("http://localhost:8080")\n    .metadata("version", "1.0.0")\n    .metadata("environment", "production")\n    .build();\n'})}),"\n",(0,r.jsx)(n.h2,{id:"registration-lifecycle-events",children:"Registration Lifecycle Events"}),"\n",(0,r.jsx)(n.p,{children:"Spring Boot Admin Client fires application events during registration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Component\npublic class RegistrationEventListener {\n\n    @EventListener\n    public void onRegistration(InstanceRegisteredEvent event) {\n        String instanceId = event.getRegistration().getInstanceId();\n        log.info("Registered with instance ID: {}", instanceId);\n    }\n\n    @EventListener\n    public void onDeregistration(InstanceDeregisteredEvent event) {\n        log.info("Deregistered instance");\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"custom-registrator",children:"Custom Registrator"}),"\n",(0,r.jsx)(n.p,{children:"Implement custom registration logic:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Component\npublic class CustomApplicationRegistrator implements ApplicationRegistrator {\n\n    private final ApplicationFactory applicationFactory;\n    private final RestClient restClient;\n    private final String adminUrl;\n    private volatile String registeredId;\n\n    @Override\n    public boolean register() {\n        Application application = applicationFactory.createApplication();\n\n        try {\n            Map<String, Object> response = restClient.post()\n                .uri(adminUrl + "/instances")\n                .body(application)\n                .retrieve()\n                .body(new ParameterizedTypeReference<Map<String, Object>>() {});\n\n            this.registeredId = (String) response.get("id");\n            log.info("Registered as: {}", registeredId);\n            return true;\n        } catch (Exception e) {\n            log.error("Registration failed", e);\n            return false;\n        }\n    }\n\n    @Override\n    public void deregister() {\n        if (registeredId != null) {\n            try {\n                restClient.delete()\n                    .uri(adminUrl + "/instances/" + registeredId)\n                    .retrieve()\n                    .toBodilessEntity();\n                log.info("Deregistered successfully");\n            } catch (Exception e) {\n                log.error("Deregistration failed", e);\n            }\n        }\n    }\n\n    @Override\n    public String getRegisteredId() {\n        return registeredId;\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"registration-fails",children:"Registration Fails"}),"\n",(0,r.jsx)(n.p,{children:"Check:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Admin Server URL is correct and accessible"}),"\n",(0,r.jsx)(n.li,{children:"Network connectivity between client and server"}),"\n",(0,r.jsx)(n.li,{children:"Firewall rules allow outbound connections"}),"\n",(0,r.jsx)(n.li,{children:"Admin Server is running and healthy"}),"\n",(0,r.jsx)(n.li,{children:"Credentials are correct if security is enabled"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"instance-not-appearing",children:"Instance Not Appearing"}),"\n",(0,r.jsx)(n.p,{children:"Verify:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Registration returned successfully (check logs)"}),"\n",(0,r.jsx)(n.li,{children:"Application name is configured"}),"\n",(0,r.jsx)(n.li,{children:"Health endpoint is accessible from Admin Server"}),"\n",(0,r.jsx)(n.li,{children:"Actuator endpoints are exposed"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"repeated-re-registrations",children:"Repeated Re-registrations"}),"\n",(0,r.jsx)(n.p,{children:"This is normal behavior - the client re-registers periodically as a heartbeat. Adjust the period if needed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  boot:\n    admin:\n      client:\n        period: 30000  # 30 seconds instead of default 10\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use environment-specific URLs"})," for service URL in different environments"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configure appropriate metadata"})," to help identify instances"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Set reasonable registration periods"})," - too frequent causes unnecessary load"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enable auto-deregistration"})," for clean shutdown"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use service discovery"})," for dynamic environments instead of direct client registration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor registration logs"})," to ensure successful registration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configure health check paths"})," correctly for proper monitoring"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/4.0.0/docs/client/metadata",children:"Metadata"})," - Learn about custom metadata"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/4.0.0/docs/client/service-discovery",children:"Service Discovery"})," - Alternative registration using Spring Cloud Discovery"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/4.0.0/docs/client/configuration",children:"Client Configuration"})," - Complete configuration reference"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/4.0.0/docs/client/client-features",children:"Client Features"})," - Additional client capabilities"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>s});var t=i(6540);const r={},a=t.createContext(r);function l(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);